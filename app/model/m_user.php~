<?php

class UserModel extends Model
{
  private $userCollection;
  function __construct()
  {
//	try
//	{
	  $userCollection = new MongoCollection($db, 'users');
	  if(!$userCollection)
		throw new Exception(messsage);
//	}
//	catch(MongoConnectionException $e)
//	{
//	  die('Error connecting to MongoDB server');
//	}
//	catch(MongoConnectionException $e)
//	{
//	  die('Error: '.$e->getMessage());
//	}
  }

  public function existence($username)
  {
	//returns the cursor to the document that matches the query else EOF  return	
	$doc = $userCollection->find(['username' => $username]); 
	if($doc->count() === 0)
		return false;
	else
		return true;
  }
  private function _existence($username)
{
	$doc = $userCollection->findOne(['username' => $username]); 
	if($doc->empty())
		throw new Exception(message);
	else
		return $doc;
 		
}
  public function authenticate($username,$password)
{
	$doc = $this->_existence($username);
	if(hash($password) === $doc['password'])
		return true;
	else
		return false;
	
}

  public function create_user($document)
  {
	//$document['password'] = hash($document['password']);
    	return $userCollection->insert($document);
    	//returns number of documents inserted
  }

  public function retrieve_user($document)
  {
    $userCollection->findOne(['username' => $document->$usr_username], function(err, result) {
      if (result)
        return result;
      else
        return null;
    });
    //returns the document asked for else returns null........refer stackoverflow

  }

  public function update_user($document)
  {
    return $userCollection->findAndModify(['username' => $document->$usr_username],);
    //returns pre-modified data after updation else null if required updation is not made

    }

    public function delete_user($document)
    {
      return db.collection.remove({username : $document->$usr_username});
      //returns object WriteResult.hasWriteError
    }
  }	

?>
